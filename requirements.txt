# Python 依赖包 - 版本固定以确保兼容性
# 环境: Python 3.11+ | CUDA 11.8 / CUDA 12.x | GPU

# ========================================
# 核心依赖 - Real-ESRGAN 超分辨率
# ========================================
realesrgan==0.3.0
basicsr==1.4.2

# ========================================
# PyTorch (GPU 版本)
# ========================================
# 兼容版本组合：torch 2.1.2 + torchvision 0.16.2
# - 支持 CUDA 11.8 和 CUDA 12.x
# - torchvision 0.16.2 仍然包含 functional_tensor 模块（虽然已弃用）
# - torchvision 0.17+ 移除了 functional_tensor，会导致 basicsr 失败
# - 不需要修改源码
#
# 安装命令:
#   CUDA 11.8: pip install torch==2.1.2 torchvision==0.16.2 --index-url https://download.pytorch.org/whl/cu118
#   CUDA 12.x: pip install torch==2.1.2 torchvision==0.16.2 --index-url https://download.pytorch.org/whl/cu121
#   CPU:      pip install torch==2.1.2 torchvision==0.16.2 --index-url https://download.pytorch.org/whl/cpu
#
# 注意：本 requirements.txt 只列出核心依赖，实际安装时请使用 install.sh 自动检测 CUDA 版本

# ========================================
# 图像/视频处理
# ========================================
opencv-python==4.10.0.84
numpy==1.26.4
Pillow==11.3.0
scipy==1.17.0
scikit-image==0.26.0

# ========================================
# basicsr 依赖 (显式声明)
# ========================================
addict==2.4.0
lmdb==1.7.5
PyYAML==6.0.3
requests==2.32.5
future==1.0.0

# ========================================
# 人脸恢复（可选，realesrgan 依赖）
# ========================================
# 注意: facexlib 和 gfpgan 可能需要额外修复
#       如果不需要人脸恢复功能，可以注释掉以下两行
# facexlib==0.3.0
# gfpgan==1.3.8

# ========================================
# 工具库
# ========================================
tqdm==4.67.3

# ========================================
# 安装说明
# ========================================
# 推荐：使用 install.sh 一键安装
#    bash install.sh        # GPU 环境
#    bash install.sh --cpu   # CPU 环境
#
# 手动安装步骤:
#
# 1. 安装 PyTorch:
#    GPU 环境 (CUDA 12.x):
#      pip install torch==2.1.2 torchvision==0.16.2 --index-url https://download.pytorch.org/whl/cu121
#    CPU 环境:
#      pip install torch==2.1.2 torchvision==0.16.2 --index-url https://download.pytorch.org/whl/cpu
#
# 2. 安装其他依赖:
#    pip install realesrgan==0.3.0 basicsr==1.4.2 opencv-python==4.10.0.84 numpy==1.26.4 \
#        Pillow==11.3.0 scipy==1.17.0 scikit-image==0.26.0 addict==2.4.0 lmdb==1.7.5 \
#        PyYAML==6.0.3 requests==2.32.5 future==1.0.0 tqdm==4.67.3
#
# 3. 系统依赖:
#    Ubuntu: apt-get install ffmpeg
#    CentOS: yum install ffmpeg
#
# 4. 模型下载 (首次运行自动下载):
#    mkdir -p ~/.realesrgan
#    wget -P ~/.realesrgan https://github.com/xinntao/Real-ESRGAN/releases/download/v0.1.0/RealESRGAN_x4plus.pth
#
# ========================================
# 版本兼容性说明
# ========================================
# 兼容组合：
#   torch 2.1.2 + torchvision 0.16.2 + basicsr 1.4.2 ✓ (推荐，无需修改源码)
#
# 不兼容组合：
#   torch 2.7.x + torchvision 0.22.x + basicsr 1.4.2 ✗ (需修改源码)
#
# 原因：
#   torchvision 0.17+ 移除了 functional_tensor 模块
#   basicsr 1.4.2 依赖此模块
#   torchvision 0.16.2 是最后一个包含此模块的版本
