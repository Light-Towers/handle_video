# Python 依赖包 - 版本固定以确保兼容性
# 环境: Python 3.11+ | CUDA 12.x | Tesla T4 GPU

# ========================================
# 核心依赖 - Real-ESRGAN 超分辨率
# ========================================
realesrgan==0.3.0
basicsr==1.4.2

# ========================================
# PyTorch (GPU 版本，支持 CUDA 12.x)
# ========================================
# torch 2.7.x 与 torchvision 0.22.x 组合测试通过
# 注意: torchvision 0.22.x 对 basicsr 1.4.2 有 API 破坏性变更
#       需要手动修改: torchvision.transforms.functional_tensor -> _functional_tensor
torch==2.7.1
torchvision==0.22.1

# ========================================
# 图像/视频处理
# ========================================
opencv-python==4.10.0.84
numpy==1.26.4
Pillow==11.3.0
scipy==1.17.0
scikit-image==0.26.0

# ========================================
# basicsr 依赖 (显式声明)
# ========================================
addict==2.4.0
lmdb==1.7.5
PyYAML==6.0.3
requests==2.32.5
future==1.0.0

# ========================================
# 人脸恢复（可选，realesrgan 依赖）
# ========================================
# 注意: facexlib 和 gfpgan 可能需要额外修复
#       如果不需要人脸恢复功能，可以注释掉以下两行
# facexlib==0.3.0
# gfpgan==1.3.8

# ========================================
# 工具库
# ========================================
tqdm==4.67.3

# ========================================
# 安装说明
# ========================================
# 1. GPU 环境 (CUDA 12.x):
#    pip install torch==2.7.1 torchvision==0.22.1 --index-url https://download.pytorch.org/whl/cu121
#    pip install -r requirements.txt --no-deps
#    pip install opencv-python numpy Pillow scipy scikit-image addict lmdb PyYAML requests future tqdm
#
# 2. CPU 环境:
#    pip install torch==2.7.1 torchvision==0.22.1 --index-url https://download.pytorch.org/whl/cpu
#    pip install -r requirements.txt --no-deps
#    pip install opencv-python numpy Pillow scipy scikit-image addict lmdb PyYAML requests future tqdm
#
# 3. 兼容性修复:
#    修改 /root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/basicsr/data/degradations.py 第 8 行
#    from: from torchvision.transforms.functional_tensor import rgb_to_grayscale
#    to:   from torchvision.transforms._functional_tensor import rgb_to_grayscale
#
# 4. 模型下载:
#    首次运行前下载 Real-ESRGAN 模型:
#    mkdir -p ~/.realesrgan
#    wget -P ~/.realesrgan https://github.com/xinntao/Real-ESRGAN/releases/download/v0.1.0/RealESRGAN_x4plus.pth
#
# 5. 系统依赖:
#    Ubuntu: apt-get install ffmpeg
#    CentOS: yum install ffmpeg
